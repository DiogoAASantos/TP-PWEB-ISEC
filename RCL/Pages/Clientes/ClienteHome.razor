@page "/Home"

@using RCL.Data.Model
@using RCL.Data.Services
@using RCL.Data.Interfaces

@inject IProdutoService Produtos
@inject NavigationManager Nav

<h2>Bem-vindo à Loja!</h2>

@if (produtos == null)
{
    <p>A carregar produtos...</p>
}
else
{
    <h3>Produtos em Destaque</h3>

    <div class="row">
        @foreach (var p in produtos)
        {
            <div class="col-12 col-sm-6 col-lg-3 mb-4">
                <div class="card h-100 shadow-sm border-0 produto-hover-card" @onclick="@(() => Nav.NavigateTo($"/produto/{p.Id}"))" style="cursor: pointer;">

                    <div class="position-relative">
                        <img src="https://via.placeholder.com/300x200?text=@p.Nome" class="card-img-top p-3" alt="@p.Nome" style="border-radius: 25px;">
                        @if (p.Stock > 0)
                        {
                            <span class="badge bg-success position-absolute top-0 end-0 m-3 shadow-sm">Em Stock</span>
                        }
                        else
                        {
                            <span class="badge bg-danger position-absolute top-0 end-0 m-3 shadow-sm">Esgotado</span>
                        }
                    </div>

                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title fw-bold text-dark mb-1">@p.Nome</h5>

                        <div class="mt-auto">
                            <span class="h4 fw-bold text-primary">@p.Preco.ToString("C2")</span>
                        </div>
                    </div>

                    <div class="card-footer bg-white border-top-0 pb-3">
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary rounded-pill d-flex align-items-center justify-content-center gap-2 shadow-sm"
                                    @onclick="@(() => Nav.NavigateTo($"/produto/{p.Id}"))">
                                <i class="bi bi-eye"></i> Ver Detalhes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
}

@code {
    private List<Produto>? produtos;

    protected override async Task OnInitializedAsync()
    {
        produtos = await Produtos.ListarProdutosAsync();
    }
}
